<h1>Register Your Vehicle</h1>

  <% if @car.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= pluralize(@car.errors.count, "error") %>
      prohibited this car from being saved: </h2>

      <ul>
        <% @car.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

<div id="new_car_form">

  <%= form_tag('/cars', method: "post") do %>
      
    <%= render 'form' %>

      <%= fields_for :parking_space_attributes do |ps| %>

        <strong><%= ps.label :space_number, "Parking Space Number:" %></strong>

        <%= ps.select :space_number, options_for_select((100..125).step(1).to_a.map{|space| ["#{space}", space]}), prompt: "Please choose your parking space" %>

      <% end %>
        
      <br></br>
    <div class="actions">
      <%= submit_tag "Create Car" %>
    </div>

  <% end %>
</div>

<div>
  <table>
    <thead>
      <tr>
        <%= render "index" %>
      </tr>
    </thead>
    <tbody>
      <td id="new_parking"></td>
      <td id="new_make"></td>
      <td id="new_model"></td>
      <td id="new_year"></td>
      <td id="new_color"></td>
      <td id="new_size"></td>
    </tbody>
  </table>
</div>

<script type="text/javascript" charset="utf-8">
  $(function () {
    $('form').submit(function(event) {
      event.preventDefault();
      const values = $(this).serialize();
      const posting = $.post('/cars', values);
      posting.done(function(data) {
        const car = data;
        $('#new_parking').text(`${car.parking_space.space_number}`);
        $('new_make').text(`${car.make}`);
        $('new_model').text(`${car.model}`);
        $('new_year').text(`${car.year}`);
        $('new_color').text(`${car.color}`);
        $('new_size').text(`${car.size}`)
      })
    })
  })
</script>



